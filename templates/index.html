<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NHL Team Stats</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f9f9f9; }
        .navbar { background: #00205b; overflow: hidden; display: flex; }
        .dropdown { position: relative; display: inline-block; }
        .dropbtn { color: white; padding: 14px 16px; text-decoration: none; background: none; border: none; cursor: pointer; font-size: 16px; }
        .dropdown-content { display: none; position: absolute; background-color: #ffffff; min-width: 200px; z-index: 1; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); }
        .dropdown-content .team-link { color: black; padding: 10px; text-decoration: none; display: flex; align-items: center; cursor: pointer; }
        .dropdown-content .team-link img { width: 20px; height: 20px; margin-right: 10px; }
        .dropdown:hover .dropdown-content { display: block; }
        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #e0e0e0; }
        #roster-title { margin: 20px 0 10px 0; font-size: 20px; }
    </style>
</head>
<body>

<div class="navbar" id="navbar">
    <!-- Divisions Dropdown will go here -->
</div>

<div class="content">
    <h2 id="roster-title"></h2>
    <table id="roster-table">
        <thead>
            <tr>
                <th>#</th>
                <th>Name</th>
                <th>Position</th>
                <th>Goals</th>
                <th>Assists</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
$(document).ready(function() {
    $.get('/teams', function(teams) {
        const divisions = {
            'Atlantic': [],
            'Metropolitan': [],
            'Central': [],
            'Pacific': []
        };

        teams.forEach(team => {
            const abbrev = team.abbrev;
            if (['BOS', 'BUF', 'DET', 'FLA', 'MTL', 'OTT', 'TBL', 'TOR'].includes(abbrev)) {
                divisions['Atlantic'].push(team);
            } else if (['CAR', 'CBJ', 'NJD', 'NYI', 'NYR', 'PHI', 'PIT', 'WSH'].includes(abbrev)) {
                divisions['Metropolitan'].push(team);
            } else if (['ARI', 'CHI', 'COL', 'DAL', 'MIN', 'NSH', 'STL', 'WPG', 'UTA'].includes(abbrev)) {
                divisions['Central'].push(team);
            } else if (['ANA', 'CGY', 'EDM', 'LAK', 'SEA', 'SJS', 'VAN', 'VGK'].includes(abbrev)) {
                divisions['Pacific'].push(team);
            }
        });

        for (const [division, teams] of Object.entries(divisions)) {
            const dropdown = $('<div>').addClass('dropdown');
            const dropbtn = $(`<button class="dropbtn">${division}</button>`);
            const dropdownContent = $('<div>').addClass('dropdown-content');

            teams.forEach(team => {
                const link = $(`<div class="team-link" data-abbrev="${team.abbrev}"><img src="${team.logo}"> ${team.name}</div>`);
                dropdownContent.append(link);
            });

            dropdown.append(dropbtn).append(dropdownContent);
            $('#navbar').append(dropdown);
        }

        $('.team-link').click(function() {
            const abbrev = $(this).data('abbrev');
            $('#roster-title').text(`Roster for ${abbrev}`);
            $.get(`/roster/${abbrev}`, function(players) {
                const tbody = $('#roster-table tbody').empty();
                players.forEach(player => {
                    tbody.append(`
                        <tr>
                            <td>${player.sweaterNumber}</td>
                            <td>${player.name}</td>
                            <td>${player.position}</td>
                            <td>${player.goals}</td>
                            <td>${player.assists}</td>
                        </tr>
                    `);
                });
            });
        });
    });
});
</script>

</body>
</html>
