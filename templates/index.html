<!DOCTYPE html>
<html>
<head>
    <title>NHL Team Roster</title>
</head>
<body>
    <h1>Select a Team</h1>
    <select id="team-select">
        <option value="">-- Select a Team --</option>
        {% for team in teams %}
            <option value="{{ team.abbrev }}">{{ team.name }}</option>
        {% endfor %}
    </select>

    <h2>Roster</h2>
    <table border="1" id="roster-table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Number</th>
                <th>Position</th>
                <th>Goals</th>
                <th>Assists</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        document.getElementById('team-select').addEventListener('change', async function() {
            const teamAbbrev = this.value;
            const tbody = document.querySelector('#roster-table tbody');
            tbody.innerHTML = '';

            if (teamAbbrev) {
                try {
                    const response = await fetch(`/roster/${teamAbbrev}`);
                    const data = await response.json();

                    if (data.length === 0) {
                        tbody.innerHTML = '<tr><td colspan="5">No roster data found.</td></tr>';
                    } else {
                        data.forEach(player => {
                            const row = `
                                <tr>
                                    <td>${player.name}</td>
                                    <td>${player.number}</td>
                                    <td>${player.position}</td>
                                    <td>${player.goals}</td>
                                    <td>${player.assists}</td>
                                </tr>`;
                            tbody.innerHTML += row;
                        });
                    }
                } catch (err) {
                    tbody.innerHTML = '<tr><td colspan="5">Error loading roster.</td></tr>';
                }
            }
        });
    </script>
</body>
</html>
