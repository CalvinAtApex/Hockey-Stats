<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NHL Team Stats</title>
</head>
<body>
    <h1>Select NHL Team</h1>
    <select id="teamSelect">
        <option value="">Select a team</option>
    </select>

    <h2 id="teamName"></h2>
    <table id="rosterTable" border="1" style="display:none;">
        <thead>
            <tr>
                <th>Number</th>
                <th>Name</th>
                <th>Position</th>
                <th>Goals</th>
                <th>Assists</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            fetch("/teams")
                .then(response => response.json())
                .then(data => {
                    const select = document.getElementById("teamSelect");
                    data.forEach(team => {
                        const option = document.createElement("option");
                        option.value = team.abbrev;
                        option.textContent = team.name;
                        select.appendChild(option);
                    });
                });

            document.getElementById("teamSelect").addEventListener("change", function() {
                const abbrev = this.value;
                if (!abbrev) return;

                fetch(`/roster/${abbrev}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.error) {
                            alert(data.error);
                            return;
                        }

                        const table = document.getElementById("rosterTable");
                        const tbody = table.querySelector("tbody");
                        tbody.innerHTML = "";

                        data.forEach(player => {
                            const row = document.createElement("tr");
                            row.innerHTML = `
                                <td>${player.number}</td>
                                <td>${player.name}</td>
                                <td>${player.position}</td>
                                <td>${player.goals}</td>
                                <td>${player.assists}</td>
                            `;
                            tbody.appendChild(row);
                        });

                        document.getElementById("teamName").textContent = abbrev;
                        table.style.display = "table";
                    })
                    .catch(error => {
                        console.error("Error loading roster:", error);
                        alert("Error loading roster.");
                    });
            });
        });
    </script>
</body>
</html>
